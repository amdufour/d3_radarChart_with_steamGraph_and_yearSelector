/*! Evolution of work Occupation by sex v0.0.1 | (c) 2020 Anne-Marie Dufour | MIT License | https://github.com/amdufour/d3_radarChart_with_steamGraph_and_yearSelector */
function radarChart(t,a,e,r){var n={width:600,height:600,margin:{top:20,right:20,bottom:20,left:20},levels:3,maxValue:1,labelFactor:1.25,wrapWidth:150,opacityArea:.35,dotRadius:4,opacityCircles:.1,strokeWidth:2,roundStrokes:!1,color:d3.scaleOrdinal(d3.schemeCategory10),glow:!1};if(void 0!==e)for(var l in e)void 0!==e[l]&&(n[l]=e[l]);var i=d3.max(a.dataPerYear[r],(function(t){return d3.max(t.map((function(t){return t.value})))})),o=Math.max(n.maxValue,Math.ceil(10*i)/10),s=a.axisLabels.map((function(t){return t.label})),c=s.length,d=2*Math.PI/c,u=Math.min(n.width/2,n.height/2),p=d3.format(".0%"),f=d3.scaleLinear().range([0,u]).domain([0,o]);d3.select(t).select("svg").remove();var h=d3.select(t).append("svg").attr("width",n.width+n.margin.left+n.margin.right).attr("height",n.height+n.margin.top+n.margin.bottom).attr("class","radar-"+t).append("g").attr("transform","translate("+(n.width/2+n.margin.left)+","+(n.height/2+n.margin.top)+")"),y=h.append("defs").append("filter").attr("id","glow"),v=(y.append("feGaussianBlur").attr("stdDeviation","2.5").attr("result","coloredBlur"),y.append("feMerge")),g=(v.append("feMergeNode").attr("in","coloredBlur"),v.append("feMergeNode").attr("in","SourceGraphic"),h.append("g").attr("class","axisWrapper"));g.selectAll(".grid-circle").data(d3.range(1,n.levels+1).reverse()).enter().append("circle").attr("class","grid-circle").attr("r",(function(t){return u/n.levels*t})).style("fill","#CDCDCD").style("stroke","#CDCDCD").style("fill-opacity",n.opacityCircles).style("filter",(function(){if(n.glow)return"url(#glow)"})),g.selectAll(".axisLabel").data(d3.range(1,n.levels+1).reverse()).enter().append("text").attr("class","axisLabel").attr("x",4).attr("y",(function(t){return-t*u/n.levels})).attr("dy","0.4rem").style("font-size","10px").attr("fill","#737373").text((function(t){return p(o*t/n.levels)}));var x=g.selectAll(".axis").data(s).enter().append("g").attr("class","axis");x.append("line").attr("x1",0).attr("y1",0).attr("x2",(function(t,a){return f(1.1*o)*Math.cos(d*a-Math.PI/2)})).attr("y2",(function(t,a){return f(1.1*o)*Math.sin(d*a-Math.PI/2)})).attr("class","line").style("stroke","white").style("stroke-width","2px"),x.append("text").attr("class","legend").style("font-size","12px").attr("text-anchor","middle").attr("dy","0.35rem").attr("x",(function(t,a){return f(o*n.labelFactor)*Math.cos(d*a-Math.PI/2)})).attr("y",(function(t,a){return f(o*n.labelFactor)*Math.sin(d*a-Math.PI/2)})).text((function(t){return t})).call((function(t,a){t.each((function(){for(var t,e=d3.select(this),r=e.text().split(/\s+/).reverse(),n=[],l=0,i=e.attr("x"),o=e.attr("y"),s=parseFloat(e.attr("dy")),c=e.text(null).append("tspan").attr("x",i).attr("y",o).attr("dy",s+"em");t=r.pop();)n.push(t),c.text(n.join(" ")),c.node().getComputedTextLength()>a&&(n.pop(),c.text(n.join(" ")),n=[t],c=e.append("tspan").attr("x",i).attr("y",o).attr("dy",1.4*++l+s+"em").text(t))}))}),n.wrapWidth);var m=d3.lineRadial().curve(d3.curveBasicClosed).radius((function(t){return f(t.value)})).angle((function(t,a){return a*d}));n.roundStrokes&&m.curve(d3.curveCardinalClosed);var M=h.selectAll(".radarWrapper").data(a.dataPerYear[r]).enter().append("g").attr("class","radarWrapper");M.append("path").attr("class","radarArea").attr("d",(function(t){return m(t)})).style("fill",(function(t,a){return n.color(a)})).style("fill-opacity",n.opacityArea).on("mouseover",(function(){d3.selectAll(".radarArea").transition().duration(200).style("fill-opacity",.1),d3.select(this).transition().duration(200).style("fill-opacity",.7)})).on("mouseout",(function(){d3.selectAll(".radarArea").transition().duration(200).style("fill-opacity",n.opacityArea)})),M.append("path").attr("class","radarStroke").attr("d",(function(t){return m(t)})).style("stroke-width",n.strokeWidth+"px").style("stroke",(function(t,a){return n.color(a)})).style("fill","none").style("filter",(function(){if(n.glow)return"url(#glow)"}));var w=0;M.selectAll(".radarCircle").data((function(t){return t})).enter().append("circle").attr("class","radarCircle").attr("r",n.dotRadius).attr("cx",(function(t,a){return f(t.value)*Math.cos(d*a-Math.PI/2)})).attr("cy",(function(t,a){return f(t.value)*Math.sin(d*a-Math.PI/2)})).style("fill",(function(t,a,e){var r=0;return a===e.length-1?(r=w,w+=1):r=w,n.color(r)})).style("fill-opacity",.8);var C=h.selectAll(".radarCircleWrapper").data(a.dataPerYear[r]).enter().append("g").attr("class","radarCircleWrapper"),A=h.append("text").attr("class","tooltip").style("opacity",0);C.selectAll(".radarInvisibleCircle").data((function(t){return t})).enter().append("circle").attr("class","radarInvisibleCircle").attr("r",1.5*n.dotRadius).attr("cx",(function(t,a){return f(t.value)*Math.cos(d*a-Math.PI/2)})).attr("cy",(function(t,a){return f(t.value)*Math.sin(d*a-Math.PI/2)})).style("fill","none").style("pointer-events","all").on("mouseover",(function(t){var a=parseFloat(d3.select(this).attr("cx"))-10,e=parseFloat(d3.select(this).attr("cy"))-10;A.attr("x",a).attr("y",e).text(p(t.value)).transition().duration(200).style("opacity",1)})).on("mouseout",(function(){A.transition().duration(200).style("opacity",0)})),window.addEventListener("click",(function(t){if(t.target.matches(".btn-year-selector")){document.getElementsByClassName("active")[0].classList.remove("active"),t.target.classList.add("active");var e=d3.transition().duration(1e3);r=t.target.innerHTML,newData=a.dataPerYear[r];var l=0,i=0,o=0,s=0,c=h.selectAll(".radarWrapper").data(newData);c.selectAll(".radarArea").data(newData).transition(e).attr("d",(function(t){return m(newData[(l+=1)-1])})).style("fill",(function(t,a){return i+=1,n.color(i-1)})),c.selectAll(".radarStroke").data(newData).transition(e).attr("d",(function(t){return m(newData[(o+=1)-1])})).style("stroke",(function(t,a){return s+=1,n.color(s-1)})),c.selectAll(".radarCircle").data((function(t){return t})).transition(e).attr("cx",(function(t,a){return f(t.value)*Math.cos(d*a-Math.PI/2)})).attr("cy",(function(t,a){return f(t.value)*Math.sin(d*a-Math.PI/2)})),h.selectAll(".radarCircleWrapper").data(newData).selectAll(".radarInvisibleCircle").data((function(t){return t})).transition(e).attr("cx",(function(t,a){return f(t.value)*Math.cos(d*a-Math.PI/2)})).attr("cy",(function(t,a){return f(t.value)*Math.sin(d*a-Math.PI/2)}))}}),!0),window.addEventListener("mousedown",(function(t){t.target.matches(".btn-year-selector")&&clearInterval(b)}));var I=document.querySelectorAll(".btn-year-selector"),P=1,b=setInterval((function(){P<I.length?(I[P].click(event,!0),++P):clearInterval(b)}),2500,P)}